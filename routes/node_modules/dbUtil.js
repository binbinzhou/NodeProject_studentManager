
var mysql = require("mysql");

var config = {
    host:"127.0.0.1",
    port:3306,
    user:"root",
    password:"123",
    database:"sms"
};
//获取连接池
var pool  = mysql.createPool(config);

var dbUtil = {
    //处理
    handler:function (sql, param, fn) {
        pool.getConnection(function (err, connection) {
            if(!err){
                connection.query(sql,param,function (err, result) {
                    fn.call(this,result);
                    //释放链接
                    connection.release();
                });
            }else{
                console.log("链接错误",err);
            }
        });
    },
    //操作
    execute: function (sql, param, fn) {
        this.handler(sql, param, fn);
    }
};

module.exports = dbUtil;